<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ingresar — SozieWAAAGH!</title>

  <link rel="icon" type="image/png" href="../imagenes/logo.jpeg">
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gradient-to-r from-green-800 via-green-500 to-green-400 text-white font-sans">

<!-- ===========================
           NAVBAR
=========================== -->
<header class="sticky top-0 z-50 bg-black/20 backdrop-blur-md">
  <div class="flex items-center justify-between px-7 py-5 relative">

    <!-- Logo -->
    <div class="flex items-center gap-3">
      <img src="../imagenes/logo.jpeg" alt="Logo ORK" class="w-12 h-12 rounded-lg">
      <span class="text-xl font-bold">SozieWAAAGH!</span>
    </div>

    <!-- Navegación centrada -->
    <nav class="absolute left-1/2 transform -translate-x-1/2">
      <ul class="flex space-x-8">
        <li><a href="index.html" class="text-blue-50 font-semibold hover:text-green-300">Inicio</a></li>
        <li><a href="sociedad.html" class="text-blue-50 font-semibold hover:text-green-300">Sociedad</a></li>
        <li><a href="comunidad.html" class="text-blue-50 font-semibold hover:text-green-300">Comunidad</a></li>
        <li><a href="Contacto.html" class="text-blue-50 font-semibold hover:text-green-300">Contacto</a></li>
      </ul>
    </nav>

    <!-- Zona dinámica -->
    <div id="navbar-user-area"></div>

  </div>
</header>


<!-- ===========================
       FORMULARIO LOGIN
=========================== -->
<div class="min-h-screen flex items-center justify-center">
  <div class="bg-green-900/50 backdrop-blur-md p-10 rounded-2xl shadow-xl w-full max-w-md">

    <!-- Tabs -->
    <div class="flex mb-6 border-b border-green-700">
      <button id="tabLogin"
              class="flex-1 pb-2 border-b-2 border-yellow-400 font-bold">
        Iniciar Sesión
      </button>
      <button id="tabRegister"
              class="flex-1 pb-2 opacity-70 hover:opacity-100 transition">
        Registrarse
      </button>
    </div>

    <!-- LOGIN -->
    <div id="loginForm" class="space-y-4">
      <input id="loginEmail" type="email" placeholder="Correo"
             class="w-full p-3 rounded text-black">
      <input id="loginPassword" type="password" placeholder="Contraseña"
             class="w-full p-3 rounded text-black">

      <button id="btnLoginEmail"
              class="w-full bg-yellow-400 text-black font-bold py-2 rounded-xl hover:bg-yellow-300 transition">
        Entrar
      </button>

      <div class="text-center opacity-80">ó</div>

      <button id="btnGoogle"
              class="w-full bg-white text-black font-bold py-2 rounded-xl hover:scale-105 transition">
        Continuar con Google
      </button>

      <p id="recoverLink"
         class="text-sm text-center underline cursor-pointer mt-3 opacity-70 hover:opacity-100">
        ¿Olvidaste tu contraseña?
      </p>
    </div>

    <!-- REGISTER -->
    <div id="registerForm" class="space-y-4 hidden">
      <input id="regEmail" type="email" placeholder="Correo"
             class="w-full p-3 rounded text-black">
      <input id="regPassword" type="password" placeholder="Contraseña"
             class="w-full p-3 rounded text-black">

      <button id="btnRegister"
              class="w-full bg-yellow-400 text-black font-bold py-2 rounded-xl hover:bg-yellow-300 transition">
        Registrarse
      </button>
    </div>

    <p id="statusMsg" class="text-center mt-5 text-sm opacity-80"></p>

  </div>
</div>


<!-- ===========================
           SCRIPTS
=========================== -->

<script type="module">
  import { 
    loginWithEmail, registerUser, loginWithGoogle, resetPassword, 
    onUserChanged 
  } from "../javascript/auth.js";

  // Tabs
  const tabLogin = document.getElementById("tabLogin");
  const tabRegister = document.getElementById("tabRegister");
  const loginForm = document.getElementById("loginForm");
  const registerForm = document.getElementById("registerForm");

  tabLogin.onclick = () => {
    tabLogin.classList.add("border-yellow-400", "font-bold");
    tabRegister.classList.remove("border-yellow-400", "font-bold");
    registerForm.classList.add("hidden");
    loginForm.classList.remove("hidden");
  };

  tabRegister.onclick = () => {
    tabRegister.classList.add("border-yellow-400", "font-bold");
    tabLogin.classList.remove("border-yellow-400", "font-bold");
    loginForm.classList.add("hidden");
    registerForm.classList.remove("hidden");
  };

  const status = document.getElementById("statusMsg");

  document.getElementById("btnLoginEmail").onclick = async () => {
    const email = loginEmail.value.trim();
    const pass = loginPassword.value.trim();
    try {
      await loginWithEmail(email, pass);
      status.innerHTML = "✅ Iniciando sesión...";
    } catch (e) {
      status.innerHTML = "❌ " + e.message;
    }
  };

  document.getElementById("btnRegister").onclick = async () => {
    const email = regEmail.value.trim();
    const pass = regPassword.value.trim();
    try {
      await registerUser(email, pass);
      status.innerHTML = "✅ Registro exitoso. Entrando...";
    } catch (e) {
      status.innerHTML = "❌ " + e.message;
    }
  };

  document.getElementById("btnGoogle").onclick = async () => {
    try {
      await loginWithGoogle();
      status.innerHTML = "✅ Autenticado con Google...";
    } catch (e) {
      status.innerHTML = "❌ " + e.message;
    }
  };

  document.getElementById("recoverLink").onclick = async () => {
    const email = prompt("Ingresa tu correo:");
    if (!email) return;

    try {
      await resetPassword(email);
      status.innerHTML = "✅ Revisa tu correo.";
    } catch (e) {
      status.innerHTML = "❌ " + e.message;
    }
  };

  onUserChanged((user) => {
    if (user) {
      status.innerHTML = `✅ Bienvenido, ${user.displayName}`;
      setTimeout(() => (window.location.href = "comunidad.html"), 1500);
    }
  });
</script>

<!-- Navbar dinámica -->
<script type="module" src="../javascript/navbar.js"></script>

</body>
</html>


